
function ENTITY:make_shape(path)
    -- Add the shape to the scene
    local shape_comp = EntityComponentShape.new()

    shape_comp:set_path(path.path, {
		scale = path.scale,
		stroke_width = path.stroke_width,
		stroke_color = path.stroke_color,
		fill_color = path.fill_color
	})

    return shape_comp;
end

function ENTITY:entity_init()
    self.data.paths = {
        {
            name = "Heart",
            path = "M 126.32,87.29 C 71.027,115.97 28.34,162.825 4.95,220.13 -27.601,153.911 -75.195,95.21 -133.31,49.75 c -44.066,-34.473 -68.824,-88.426 -66.219,-144.31 0.38672,-8.2695 1.7109,-16.355 3.7617,-24.215 l 100.91,50.434 c 2.0234,1.0078 4.4375,0.76172 6.1875,-0.69141 l 29.832,-24.445 -34.086,93.367 c -0.96875,2.6602 0.14453,5.6367 2.6289,6.9883 2.5,1.375 5.5898,0.69141 7.3008,-1.5547 l 84.031,-110.21 -32.723,98.723 c -0.78906,2.3711 0.0547,4.9766 2.0781,6.4414 2.0312,1.4766 4.7617,1.4414 6.7695,-0.043 l 26.227,-19.48 160,79.961 c -10.816,10.309 -23.152,19.355 -37.07,26.574 z M 171.72,52.08 5.36,-31.057 c -1.9297,-0.96094 -4.2383,-0.76172 -5.9766,0.52734 l -14.504,10.77 37.793,-114.02 c 0.87891,-2.6484 -0.28516,-5.5586 -2.7617,-6.8672 -2.4766,-1.2969 -5.5312,-0.63672 -7.2227,1.5977 l -81.93,107.46 28.328,-77.59 c 0.88281,-2.4258 0.0391,-5.1445 -2.0625,-6.6406 -2.1016,-1.5 -4.9414,-1.3867 -6.9453,0.24609 l -43.145,35.348 -99.211,-49.59 c 6.0195,-16.234 15.543,-31.078 28.281,-43.398 22.676,-21.918 52,-32.82 81.297,-32.82 30.617,0 61.211,11.91 84.121,35.613 2.0742,2.1367 5.4297,2.3477 7.7383,0.44531 6.5117,-5.3125 13.613,-9.9844 21.102,-13.867 60.039,-31.199 134.23,-7.6484 165.39,52.422 32.031,61.75 20.191,134.7 -23.93,183.5 z",
            scale = 1.0,
            stroke_width = 2.0,
            stroke_color = Color.new(0.53, 0.03, 0.03, 1.0),
            fill_color = Color.new(0.53, 0.03, 0.03, 0.8),
        },
        {
            name = "Dumbell",
            path = "M 5.2346,4.8478 4.9476,5.5407 Z M 4,1.5 H 4.75 C 4.75,1.0858 4.4142,0.75 4,0.75 Z m 0.1522,2.2654 -0.6929,0.287 z m 5.6956,0 0.6929,0.287 z M 8.7654,4.8478 8.4784,4.1548 Z m 0,-9.69556 -0.287,0.69291 v 0 z m 1.0824,1.08239 0.6929,-0.28701 z M 5.2346,-4.84776 4.9476,-5.54067 v 0 z M 4,-1.5 v 0.75 c 0.4142,0 0.75,-0.3358 0.75,-0.75 z M 4.1522,-3.76537 3.4593,-4.05238 Z M -8.76537,4.8478 -9.05238,5.5407 Z m -1.08239,-1.0824 -0.69291,0.287 v 0 z M -4,1.5 V 0.75 c -0.41421,0 -0.75,0.3358 -0.75,0.75 z m -0.15224,2.2654 0.69291,0.287 z m -1.08239,1.0824 0.28701,0.6929 v 0 z m 0,-9.69556 0.28701,-0.69291 v 0 z M -4,-1.5 h -0.75 c 0,0.4142 0.33579,0.75 0.75,0.75 z m -0.15224,-2.26537 0.69291,-0.28701 z m -4.61313,-1.08239 -0.28701,-0.69291 z m -1.08239,1.08239 -0.69291,-0.28701 z M 9.25,-2 v 4 h 1.5 V -2 Z M 7,4.25 C 6.5238,4.25 6.2042,4.2496 5.9567,4.2327 5.716,4.2163 5.5988,4.1868 5.5216,4.1548 L 4.9476,5.5407 C 5.238,5.661 5.5375,5.7076 5.8546,5.7292 6.165,5.7504 6.5443,5.75 7,5.75 Z M 3.25,1.5 c 0,0.461 -2e-4,0.9545 0.0199,1.3796 0.01,0.2132 0.0256,0.4218 0.0512,0.6093 0.0241,0.1765 0.063,0.3817 0.1382,0.5635 L 4.8452,3.4784 C 4.847,3.4828 4.8416,3.4703 4.8329,3.4328 4.8247,3.3969 4.8159,3.3485 4.8073,3.2859 4.7901,3.1597 4.7772,2.9997 4.7682,2.809 4.7502,2.4263 4.75,1.9709 4.75,1.5 Z M 5.5216,4.1548 C 5.2154,4.028 4.972,3.7846 4.8452,3.4784 L 3.4593,4.0524 C 3.7384,4.7262 4.2738,5.2616 4.9476,5.5407 Z M 9.25,2 c 0,0.4762 -4e-4,0.7958 -0.0173,1.0433 C 9.2163,3.284 9.1868,3.4012 9.1549,3.4784 l 1.3858,0.574 C 10.661,3.762 10.7076,3.4625 10.7292,3.1454 10.7504,2.835 10.75,2.4557 10.75,2 Z M 7,5.75 c 0.4557,0 0.835,4e-4 1.1454,-0.0208 C 8.4625,5.7076 8.762,5.661 9.0524,5.5407 L 8.4784,4.1548 C 8.4012,4.1868 8.284,4.2163 8.0433,4.2327 7.7958,4.2496 7.4762,4.25 7,4.25 Z M 9.1549,3.4784 C 9.028,3.7846 8.7846,4.028 8.4784,4.1548 l 0.574,1.3859 C 9.7262,5.2616 10.2616,4.7262 10.5407,4.0524 Z M 7,-4.25 c 0.4762,0 0.7958,4.1e-4 1.0433,0.01729 0.2407,0.01643 0.3579,0.0459 0.4351,0.07786 l 0.574,-1.38582 C 8.762,-5.66095 8.4625,-5.70759 8.1454,-5.72923 7.835,-5.75041 7.4557,-5.75 7,-5.75 Z M 10.75,-2 c 0,-0.45568 4e-4,-0.835 -0.0208,-1.14536 -0.0216,-0.3171 -0.0682,-0.61663 -0.1885,-0.90702 L 9.1549,-3.47835 C 9.1868,-3.4012 9.2163,-3.28399 9.2327,-3.04326 9.2496,-2.79579 9.25,-2.4762 9.25,-2 Z M 8.4784,-4.15485 c 0.3062,0.12687 0.5496,0.37021 0.6765,0.6765 l 1.3858,-0.57403 C 10.2616,-4.72621 9.7262,-5.26156 9.0524,-5.54067 Z M 7,-5.75 c -0.4557,0 -0.835,-4.1e-4 -1.1454,0.02077 -0.3171,0.02164 -0.6166,0.06828 -0.907,0.18856 l 0.574,1.38582 C 5.5988,-4.18681 5.716,-4.21628 5.9567,-4.23271 6.2042,-4.24959 6.5238,-4.25 7,-4.25 Z M 4.75,-1.5 c 0,-0.4709 2e-4,-0.9263 0.0182,-1.30901 0.009,-0.19073 0.0219,-0.35073 0.0391,-0.47692 0.0086,-0.0626 0.0174,-0.111 0.0256,-0.14683 0.0087,-0.03756 0.0141,-0.05009 0.0123,-0.04559 L 3.4593,-4.05238 C 3.3841,-3.87065 3.3452,-3.66543 3.3211,-3.48885 3.2955,-3.30144 3.2799,-3.0928 3.2699,-2.87961 3.2498,-2.4545 3.25,-1.961 3.25,-1.5 Z m 0.1976,-4.04067 c -0.6738,0.27911 -1.2092,0.81446 -1.4883,1.48829 l 1.3859,0.57403 C 4.972,-3.78464 5.2154,-4.02798 5.5216,-4.15485 Z M -9.25,2 v -4 h -1.5 V 2 Z M -7,4.25 c -0.4762,0 -0.79579,-4e-4 -1.04326,-0.0173 C -8.28399,4.2163 -8.4012,4.1868 -8.47835,4.1548 L -9.05238,5.5407 C -8.76199,5.661 -8.46246,5.7076 -8.14536,5.7292 -7.835,5.7504 -7.45568,5.75 -7,5.75 Z M -10.75,2 c 0,0.4557 -4.1e-4,0.835 0.02077,1.1454 0.02164,0.3171 0.06828,0.6166 0.18856,0.907 l 1.38582,-0.574 C -9.18681,3.4012 -9.21628,3.284 -9.23271,3.0433 -9.24959,2.7958 -9.25,2.4762 -9.25,2 Z m 2.27165,2.1548 C -8.78464,4.028 -9.02798,3.7846 -9.15485,3.4784 l -1.38582,0.574 c 0.27911,0.6738 0.81446,1.2092 1.48829,1.4883 z M -4.75,1.5 c 0,0.4709 -1.7e-4,0.9263 -0.0182,1.309 -0.00898,0.1907 -0.0219,0.3507 -0.03913,0.4769 -0.00855,0.0626 -0.01738,0.111 -0.02561,0.1469 -0.00863,0.0375 -0.01407,0.05 -0.01221,0.0456 l 1.38582,0.574 C -3.38405,3.8706 -3.34523,3.6654 -3.32112,3.4889 -3.29553,3.3014 -3.27991,3.0928 -3.26986,2.8796 -3.24983,2.4545 -3.25,1.961 -3.25,1.5 Z M -7,5.75 c 0.45568,0 0.835,4e-4 1.14536,-0.0208 0.3171,-0.0216 0.61663,-0.0682 0.90702,-0.1885 L -5.52165,4.1548 C -5.5988,4.1868 -5.71601,4.2163 -5.95674,4.2327 -6.20421,4.2496 -6.5238,4.25 -7,4.25 Z m 2.15485,-2.2716 c -0.12687,0.3062 -0.37021,0.5496 -0.6765,0.6764 l 0.57403,1.3859 C -4.27379,5.2616 -3.73844,4.7262 -3.45933,4.0524 Z M -7,-4.25 c 0.4762,0 0.79579,4.1e-4 1.04326,0.01729 0.24073,0.01643 0.35794,0.0459 0.43509,0.07786 l 0.57403,-1.38582 C -5.23801,-5.66095 -5.53754,-5.70759 -5.85464,-5.72923 -6.165,-5.75041 -6.54432,-5.75 -7,-5.75 Z m 3.75,2.75 c 0,-0.461 1.7e-4,-0.9545 -0.01986,-1.37961 -0.01005,-0.21319 -0.02567,-0.42183 -0.05126,-0.60924 -0.02411,-0.17658 -0.06293,-0.3818 -0.13821,-0.56353 l -1.38582,0.57403 c -0.00186,-0.0045 0.00358,0.00803 0.01221,0.04559 0.00823,0.03583 0.01706,0.08423 0.02561,0.14683 0.01723,0.12619 0.03015,0.28619 0.03913,0.47692 C -4.75017,-2.4263 -4.75,-1.9709 -4.75,-1.5 Z m -2.27165,-2.65485 c 0.30629,0.12687 0.54963,0.37021 0.6765,0.6765 l 1.38582,-0.57403 C -3.73844,-4.72621 -4.27379,-5.26156 -4.94762,-5.54067 Z M -7,-5.75 c -0.45568,0 -0.835,-4.1e-4 -1.14536,0.02077 -0.3171,0.02164 -0.61663,0.06828 -0.90702,0.18856 l 0.57403,1.38582 C -8.4012,-4.18681 -8.28399,-4.21628 -8.04326,-4.23271 -7.79579,-4.24959 -7.4762,-4.25 -7,-4.25 Z M -9.25,-2 c 0,-0.4762 4.1e-4,-0.79579 0.01729,-1.04326 0.01643,-0.24073 0.0459,-0.35794 0.07786,-0.43509 l -1.38582,-0.57403 c -0.12028,0.29039 -0.16692,0.58992 -0.18856,0.90702 C -10.75041,-2.835 -10.75,-2.45568 -10.75,-2 Z m 0.19762,-3.54067 c -0.67383,0.27911 -1.20918,0.81446 -1.48829,1.48829 l 1.38582,0.57403 c 0.12687,-0.30629 0.37021,-0.54963 0.6765,-0.6765 z M -4,-0.75 h 8 v -1.5 h -8 z m 8,1.5 h -8 v 1.5 h 8 z",
            scale = 25.0,
            stroke_width = 2.0,
            stroke_color = Color.new(0.85, 0.85, 0.85, 1.0),
            fill_color = Color.new(0.85, 0.85, 0.85, 1.0),
        },
    }

    self.data.current_path = 1
    self.data.timer = 0;

    local path = self.data.paths[self.data.current_path]
    self.components:add(ENTITY:make_shape(path))
end

function ENTITY:entity_update(delta_time)
    self.data.timer = self.data.timer + delta_time

    if self.data.timer > 3.0 then
        self.data.current_path = self.data.current_path + 1
        if self.data.current_path > #self.data.paths then
            self.data.current_path = 1
        end
        self.data.timer = 0

        local found_indexes = self.components:find("EntityComponentShape");
        if #found_indexes ~= 1 then
            return;
        end  

        local shape_comp = self.components[found_indexes[1]]
        self.components:remove(shape_comp)

        local path = self.data.paths[self.data.current_path]
        self.components:add(ENTITY:make_shape(path))
    end
end